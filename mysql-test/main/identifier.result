#
# Start of 11.5 tests
#
#
# MDEV-31340 Remove MY_COLLATION_HANDLER::strcasecmp()
#
SET NAMES utf8;
CREATE TABLE t1 (I int, Ä± int);
ERROR 42S21: Duplicate column name 'Ä±'
CREATE TABLE t1 (a int, b int, KEY I(a), KEY Ä±(b));
ERROR 42000: Duplicate key name 'Ä±'
SET @@lc_time_names=it_Ä±T;
SELECT @@lc_time_names;
@@lc_time_names
it_IT
SET @@lc_time_names=DEFAULT;
CREATE VIEW v1 AS SELECT 1;
SELECT COUNT(*) FROM INFORMATION_SCHEMA.VIEWS WHERE TABLE_NAME='v1';
COUNT(*)
1
SELECT COUNT(*) FROM INFORMATION_SCHEMA.VÄ±EWS WHERE TABLE_NAME='v1';
COUNT(*)
1
DROP VIEW v1;
CREATE OR REPLACE TABLE t1 (pk int, c int);
INSERT INTO t1 VALUES (1,1);
INSERT INTO t1 VALUES (1,2);
INSERT INTO t1 VALUES (1,3);
INSERT INTO t1 VALUES (2,1);
INSERT INTO t1 VALUES (2,2);
INSERT INTO t1 VALUES (2,3);
SELECT pk, COUNT(*) OVER I AS cnt
FROM t1
WINDOW Ä± AS (PARTITION BY c ORDER BY pk ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING);
pk	cnt
1	2
2	2
1	2
2	2
1	2
2	2
DROP TABLE t1;
SELECT CEIL(10.6);
CEIL(10.6)
11
SELECT CEÄ±L(10.6);
CEÄ±L(10.6)
11
CREATE FUNCTION I() RETURNS INT RETURN 1;
SELECT Ä±();
Ä±()
1
DROP FUNCTION Ä±;
WITH I AS (SELECT 'a1' AS a, 'b1' AS b) SELECT * FROM Ä±;
a	b
a1	b1
INSTALL PLUGIN arÄ±a SONAME 'not important';
ERROR HY000: Plugin 'arÄ±a' already installed
CREATE TABLE t1 (a INT) ENGINE=MyÄ±SAM;
SHOW CREATE TABLE t1;
Table	Create Table
t1	CREATE TABLE `t1` (
  `a` int(11) DEFAULT NULL
) ENGINE=MyISAM DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_uca1400_ai_ci
DROP TABLE t1;
SELECT @@CHARACTER_SET_CLÄ±ENT;
@@CHARACTER_SET_CLÄ±ENT
utf8mb3
SET @I='i';
SELECT @Ä±;
@Ä±
i
CREATE TABLE t1(
x INT,
start_timestamp TIMESTAMP(6) GENERATED ALWAYS AS ROW START,
end_timestamp TIMESTAMP(6) GENERATED ALWAYS AS ROW END,
PERIOD FOR SYSTEM_TIME(start_tÄ±mestamp, end_tÄ±mestamp)
) WITH SYSTEM VERSIONING;
SHOW CREATE TABLE t1;
Table	Create Table
t1	CREATE TABLE `t1` (
  `x` int(11) DEFAULT NULL,
  `start_timestamp` timestamp(6) GENERATED ALWAYS AS ROW START,
  `end_timestamp` timestamp(6) GENERATED ALWAYS AS ROW END,
  PERIOD FOR SYSTEM_TIME (`start_timestamp`, `end_timestamp`)
) ENGINE=MyISAM DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_uca1400_ai_ci WITH SYSTEM VERSIONING
DROP TABLE t1;
BEGIN NOT ATOMIC
label_Ä±:
LOOP
label_I:
LOOP
LEAVE label_I;
END LOOP;
LEAVE label_Ä±;
END LOOP;
END;
$$
ERROR 42000: Redefining label label_I
BEGIN NOT ATOMIC
label_Ä±:
LOOP
SELECT 'looping' AS stage;
LEAVE label_I;
END LOOP;
SELECT 'out of loop' AS stage;
END;
$$
stage
looping
stage
out of loop
CREATE TABLE t1 (a INT);
INSERT INTO t1 VALUES (1),(2),(3);
SELECT 'a' AS I FROM t1 GROUP BY Ä±;
I
a
SELECT 'a' AS Ä± FROM t1 GROUP BY I;
Ä±
a
SELECT 'a' AS Ä° FROM t1 GROUP BY i;
ERROR 42S22: Unknown column 'i' in 'group statement'
SELECT 'a' AS i FROM t1 GROUP BY Ä°;
ERROR 42S22: Unknown column 'Ä°' in 'group statement'
DROP TABLE t1;
#
# End of 11.5 tests
#
#
# Start of 11.7 tests
#
#
# MDEV-27490 Allow full utf8mb4 for identifiers
#
SET NAMES utf8mb4;
CREATE DATABASE ðŸ˜Ž;
SELECT * FROM INFORMATION_SCHEMA.SCHEMATA WHERE SCHEMA_NAME='ðŸ˜Ž';
CATALOG_NAME	SCHEMA_NAME	DEFAULT_CHARACTER_SET_NAME	DEFAULT_COLLATION_NAME	SQL_PATH	SCHEMA_COMMENT
def	ðŸ˜Ž	utf8mb4	utf8mb4_uca1400_ai_ci	NULL	
SHOW DATABASES LIKE 'ðŸ˜Ž';
Database (ðŸ˜Ž)
ðŸ˜Ž
CREATE TABLE ðŸ˜Ž.ðŸ˜Ž (a INT);
SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME='ðŸ˜Ž';
TABLE_NAME
ðŸ˜Ž
SHOW TABLES IN ðŸ˜Ž;
Tables_in_ðŸ˜Ž
ðŸ˜Ž
SELECT TABLE_NAME, COLUMN_NAME FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME='ðŸ˜Ž';
TABLE_NAME	COLUMN_NAME
ðŸ˜Ž	a
SHOW COLUMNS IN ðŸ˜Ž.ðŸ˜Ž;
Field	Type	Null	Key	Default	Extra
a	int(11)	YES		NULL	
DROP TABLE ðŸ˜Ž.ðŸ˜Ž;
DROP DATABASE ðŸ˜Ž;
CREATE DATABASE ðŸ˜Ž;
CREATE TABLE ðŸ˜Ž.ðŸ˜Ž (a INT);
DROP DATABASE ðŸ˜Ž;
CREATE DATABASE ðŸ˜Ž;
CREATE FUNCTION ðŸ˜Ž.ðŸ˜Ž(ðŸ˜Ž INT) RETURNS INT RETURN 1;
SELECT ROUTINE_SCHEMA, ROUTINE_NAME FROM INFORMATION_SCHEMA.ROUTINES WHERE ROUTINE_NAME='ðŸ˜Ž';
ROUTINE_SCHEMA	ROUTINE_NAME
ðŸ˜Ž	ðŸ˜Ž
SELECT SPECIFIC_SCHEMA, SPECIFIC_NAME, PARAMETER_NAME FROM INFORMATION_SCHEMA.PARAMETERS WHERE SPECIFIC_SCHEMA='ðŸ˜Ž';
SPECIFIC_SCHEMA	SPECIFIC_NAME	PARAMETER_NAME
ðŸ˜Ž	ðŸ˜Ž	NULL
ðŸ˜Ž	ðŸ˜Ž	ðŸ˜Ž
SHOW CREATE FUNCTION ðŸ˜Ž.ðŸ˜Ž;
Function	sql_mode	Create Function	character_set_client	collation_connection	Database Collation
ðŸ˜Ž	STRICT_TRANS_TABLES,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION	CREATE DEFINER=`root`@`localhost` FUNCTION `ðŸ˜Ž`(ðŸ˜Ž INT) RETURNS int(11)
RETURN 1	utf8mb4	utf8mb4_uca1400_ai_ci	utf8mb4_uca1400_ai_ci
SELECT ðŸ˜Ž.ðŸ˜Ž(1);
ðŸ˜Ž.ðŸ˜Ž(1)
1
DROP FUNCTION ðŸ˜Ž.ðŸ˜Ž;
DROP DATABASE ðŸ˜Ž;
CREATE DATABASE ðŸ˜Ž;
CREATE FUNCTION ðŸ˜Ž.ðŸ˜Ž(ðŸ˜Ž INT) RETURNS INT RETURN 1;
DROP DATABASE ðŸ˜Ž;
CREATE DATABASE ðŸ˜Ž;
CREATE PROCEDURE ðŸ˜Ž.ðŸ˜Ž(ðŸ˜Ž INT)
BEGIN
SELECT 'ðŸ˜Ž';
END
$$
SELECT ROUTINE_SCHEMA, ROUTINE_NAME FROM INFORMATION_SCHEMA.ROUTINES WHERE ROUTINE_NAME='ðŸ˜Ž';
ROUTINE_SCHEMA	ROUTINE_NAME
ðŸ˜Ž	ðŸ˜Ž
SELECT SPECIFIC_SCHEMA, SPECIFIC_NAME, PARAMETER_NAME FROM INFORMATION_SCHEMA.PARAMETERS WHERE SPECIFIC_SCHEMA='ðŸ˜Ž';
SPECIFIC_SCHEMA	SPECIFIC_NAME	PARAMETER_NAME
ðŸ˜Ž	ðŸ˜Ž	ðŸ˜Ž
SHOW CREATE PROCEDURE ðŸ˜Ž.ðŸ˜Ž;
Procedure	sql_mode	Create Procedure	character_set_client	collation_connection	Database Collation
ðŸ˜Ž	STRICT_TRANS_TABLES,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION	CREATE DEFINER=`root`@`localhost` PROCEDURE `ðŸ˜Ž`(ðŸ˜Ž INT)
BEGIN
SELECT 'ðŸ˜Ž';
END	utf8mb4	utf8mb4_uca1400_ai_ci	utf8mb4_uca1400_ai_ci
CALL ðŸ˜Ž.ðŸ˜Ž(1);
ðŸ˜Ž
ðŸ˜Ž
DROP PROCEDURE ðŸ˜Ž.ðŸ˜Ž;
DROP DATABASE ðŸ˜Ž;
CREATE DATABASE ðŸ˜Ž;
CREATE PROCEDURE ðŸ˜Ž.ðŸ˜Ž(ðŸ˜Ž INT)
BEGIN
SELECT 'ðŸ˜Ž';
END
$$
DROP DATABASE ðŸ˜Ž;
#
# End of 11.7 tests
#
